<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>CRT Screener Dashboard</title>

  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #f4f6f8;
      color: #222;
    }

    header {
      background: #111;
      color: #fff;
      padding: 14px 20px;
      font-size: 20px;
      font-weight: bold;
    }

    .controls {
      display: flex;
      gap: 10px;
      padding: 15px 20px;
      background: #fff;
      border-bottom: 1px solid #ddd;
    }

    select, input, button {
      padding: 8px 12px;
      font-size: 14px;
    }

    button {
      background: #0b5ed7;
      color: white;
      border: none;
      cursor: pointer;
    }

    button:hover {
      background: #084298;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: #fff;
      margin-top: 10px;
    }

    thead {
      background: #000;
      color: #fff;
    }

    th, td {
      padding: 10px;
      border-bottom: 1px solid #e5e5e5;
      text-align: left;
      font-size: 14px;
    }

    tbody tr:hover {
      background: #f1f5ff;
    }

    .container {
      padding: 0 20px 40px;
    }

    .status {
      padding: 20px;
      text-align: center;
      color: #666;
    }

    .crt {
      font-weight: bold;
    }

    .bullish {
      color: green;
    }

    .bearish {
      color: red;
    }
  </style>
</head>

<body>

<header>
  CRT Screener Dashboard
</header>

<div class="controls">
  <select id="tf">
    <option value="daily">Daily</option>
    <option value="weekly">Weekly</option>
    <option value="monthly">Monthly</option>
  </select>

  <input type="text" id="search" placeholder="Search symbol..." />

  <button onclick="runScan()">Run Scan</button>
</div>

<div class="container">
  <table>
    <thead>
      <tr>
        <th>Symbol</th>
        <th>Timeframe</th>
        <th>CRT Type</th>
        <th>Chart</th>
      </tr>
    </thead>
    <tbody id="rows">
      <tr>
        <td colspan="4" class="status">
          Run scan to see results
        </td>
      </tr>
    </tbody>
  </table>
</div>

<script>
  const BACKEND = "https://YOUR_BACKEND_URL";

  async function runScan() {
    const tf = document.getElementById("tf").value;
    const tbody = document.getElementById("rows");

    tbody.innerHTML = `
      <tr>
        <td colspan="4" class="status">Scanning markets...</td>
      </tr>
    `;

    try {
      const res = await fetch(`${BACKEND}/scan?tf=${tf}`);
      const data = await res.json();

      if (!data.results || data.results.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="4" class="status">
              No CRT found for selected timeframe
            </td>
          </tr>
        `;
        return;
      }

      tbody.innerHTML = "";

      data.results.forEach(r => {
        const tr = document.createElement("tr");

        const crtClass =
          r.type.toLowerCase().includes("bull") ? "bullish" :
          r.type.toLowerCase().includes("bear") ? "bearish" : "";

        tr.innerHTML = `
          <td>${r.symbol}</td>
          <td>${r.timeframe}</td>
          <td class="crt ${crtClass}">${r.type}</td>
          <td>
            <a href="https://www.tradingview.com/chart/?symbol=${r.symbol}"
               target="_blank">
              View
            </a>
          </td>
        `;

        tbody.appendChild(tr);
      });

    } catch (err) {
      tbody.innerHTML = `
        <tr>
          <td colspan="4" class="status">
            Backend not reachable
          </td>
        </tr>
      `;
    }
  }
</script>

</body>
</html>
